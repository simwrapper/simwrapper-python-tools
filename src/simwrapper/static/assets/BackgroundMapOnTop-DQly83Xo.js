import{d as m,C as n,g as r,m as p,n as l}from"./index-BX7jQcoh.js";const h=m({name:"BackgroundMapOnTop",components:{},data:()=>({containerId:`c${Math.floor(1e12*Math.random())}`,globalState:r.state,isDarkMode:!1,isMapMoving:!1,mapId:`map-${Math.floor(1e12*Math.random())}`,layerId:Math.floor(1e12*Math.random()),mymap:{},resizer:null,isMapReady:!1}),computed:{},methods:{setupResizer(){this.resizer=new ResizeObserver(()=>{this.mymap.resize()});const t=document.getElementById(this.containerId);this.resizer.observe(t)},handleMapMotion(){if(!this.isMapReady)return;const t={longitude:this.mymap.getCenter().lng,latitude:this.mymap.getCenter().lat,bearing:this.mymap.getBearing(),zoom:this.mymap.getZoom(),pitch:this.mymap.getPitch()};this.$store.commit("setMapCamera",t),this.isMapMoving||(this.isMapMoving=!0)},setupMap(){const t=r.state.mapStyles;try{this.mymap=new p.Map({container:this.mapId,style:this.isDarkMode?t.transparentDark:t.transparentLight,logoPosition:"top-left"});const{jump:e,initial:o,startup:i,...s}=this.globalState.viewState;s.center=[s.longitude,s.latitude],this.mymap.jumpTo(s)}catch(e){console.error("HUH?"+e);return}this.mymap.on("load",this.mapIsReady);let a=document.getElementsByClassName("mapboxgl-ctrl mapboxgl-ctrl-attrib mapboxgl-compact");for(const e of a)e.setAttribute("style","display: none");a=document.getElementsByClassName("mapboxgl-ctrl mapboxgl-ctrl-group");for(const e of a)e.setAttribute("style","display: none");a=document.getElementsByClassName("mapboxgl-ctrl-logo");for(const e of a)e.setAttribute("style","display: none")},async mapIsReady(){this.isMapReady=!0,this.setupResizer(),this.mymap.on("move",this.handleMapMotion)},viewMoved(t){if(!this.isMapReady)return;if(!this.mymap||this.isMapMoving){this.isMapMoving=!1;return}const{bearing:a,longitude:e,latitude:o,zoom:i,pitch:s}=t;!e||!o||!i||(this.mymap.off("move",this.handleMapMotion),this.mymap.jumpTo({bearing:a,zoom:i,center:[e,o],pitch:s}),this.mymap.on("move",this.handleMapMotion))}},watch:{"globalState.viewState"(t){this.viewMoved(t)},"$store.state.colorScheme"(){if(this.isDarkMode=this.$store.state.colorScheme===n.DarkMode,!this.mymap)return;const t=r.state.mapStyles;this.mymap.setStyle(this.isDarkMode?t.transparentDark:t.transparentLight),this.mymap.on("style.load",()=>{})},"$store.state.resizeEvents"(){this.mymap&&this.mymap.resize()}},beforeDestroy(){this.resizer?.disconnect()},mounted(){this.isDarkMode=this.$store.state.colorScheme===n.DarkMode,this.setupMap()}});var d=function(){var a=this,e=a._self._c;return a._self._setupProxy,e("div",{staticClass:"mymaplibre-map",attrs:{id:a.containerId}},[e("div",{staticClass:"mymap",attrs:{id:a.mapId}})])},c=[],y=l(h,d,c,!1,null,"f469fa8b");const u=y.exports;export{u as B};
